---
layout: layout
---

<h1>Example</h1>

<a href="https://github.com/rkusa/pdfjs/tree/master/docs">View API Docs</a>, <a href="#source">View Example Source</a>

<div id="progress" class="progress progress-striped active">
  <div class="progress-bar" id="progressbar"></div>
</div>

<iframe id="preview" width="100%" height="650" frameborder="0"></iframe>

<a name="source"></a>

{% highlight javascript %}
var doc = new pdfjs.Document({
  font: assets.openSansRegular
})

var tr, td, text

var header = doc.header()
table = header.table({ widths: ['50%', '50%']})
tr = table.tr()
tr.td('pdfjs', { font: assets.openSansBold })
tr.td('github.com/rkusa/pdfjs', { font: assets.openSansLight, textAlign: 'right' })

var footer = doc.footer()
footer.text({ textAlign: 'center' }).pageNumber().append('/').pageCount()

doc.image(assets.logo, { width: 128 })

text = doc.text({
  fontSize: 14, lineSpacing: 1.35
})

text.add('Content can be composed of')
text.add('different', { font: assets.openSansBold })
text.add('fonts', { font: assets.sourceCodeProMedium })
text.add('and')
text.add('different', { fontSize: 10 })
text.add('sizes', { fontSize: 18 })
text.add('.')

var lorem = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cum id fugiunt, re eadem quae Peripatetici, verba. Tenesne igitur, inquam, Hieronymus Rhodius quid dicat esse summum bonum, quo putet omnia referri oportere? Quia nec honesto quic quam honestius nec turpi turpius.'

doc.text(new Array(2).join(lorem + '\n\n'), {
  fontSize: 14, lineSpacing: 1.35, textAlign: 'justify', color: 0xdddddd
})

table = doc.table({
  headerRows: 1, fontSize: 14,
  borderHorizontalWidth: 0.1,
  widths: ['10%', '10%', '50%', '15%', '15%']
})

tr = table.tr({ font: assets.openSansBold, borderBottomWidth: 1.5 })
tr.td('#')
tr.td('Unit')
tr.td('Subject')
tr.td('Price')
tr.td('Total')

var rows = [
  {
    quantity: 2,
    name: 'Article A',
    description: lorem,
    price: 500
  },
  {
    quantity: 1,
    name: 'Article B',
    description: lorem,
    price: 250
  },
  {
    quantity: 3,
    name: 'Article C',
    description: lorem,
    price: 750
  }
]

rows.forEach(function(row) {
  tr = table.tr()
  tr.td(row.quantity)
  tr.td('pc.')

  var article = tr.td().text()
  article.add(row.name, { fontSize: 14, font: assets.openSansBold })
         .br()
         .add(lorem, { fontSize: 11, textAlign: 'justify' })

  tr.td(row.price.toFixed(2) + ' €', { textAlign: 'right' })
  tr.td((row.price * row.quantity).toFixed(2) + ' €', { textAlign: 'right' })
})

var pdf = doc.render()

document.querySelector('#preview').setAttribute('src', pdf.toDataURL())
{% endhighlight %}

<script type="text/javascript">
  function load(path, callback) {
    var request = new XMLHttpRequest()
    request.open('GET', path, true)
    request.responseType = 'arraybuffer'

    if (request.overrideMimeType) {
        request.overrideMimeType('text/plain; charset=x-user-defined')
    } else {
        request.setRequestHeader('Accept-Charset', 'x-user-defined')
    }

    request.onload = function() {
      if (request.status === 200) {
        callback(null, request.response)
      } else {
        callback(request.status)
      }
    }

    request.send(null)
  }

  function build(assets) {
    var doc = new pdfjs.Document({
      font: assets.openSansRegular
    })

    var tr, td, text

    var header = doc.header()
    table = header.table({ widths: ['50%', '50%']})
    tr = table.tr()
    tr.td('pdfjs', { font: assets.openSansBold })
    tr.td('github.com/rkusa/pdfjs', { font: assets.openSansLight, textAlign: 'right' })

    var footer = doc.footer()
    footer.text({ textAlign: 'center' }).pageNumber().append('/').pageCount()

    doc.image(assets.logo, { width: 128 })

    text = doc.text({
      fontSize: 14, lineSpacing: 1.35
    })

    text.add('Content can be composed of')
    text.add('different', { font: assets.openSansBold })
    text.add('fonts', { font: assets.sourceCodeProMedium })
    text.add('and')
    text.add('different', { fontSize: 10 })
    text.add('sizes', { fontSize: 18 })
    text.add('.')

    var lorem = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cum id fugiunt, re eadem quae Peripatetici, verba. Tenesne igitur, inquam, Hieronymus Rhodius quid dicat esse summum bonum, quo putet omnia referri oportere? Quia nec honesto quic quam honestius nec turpi turpius.'

    doc.text(new Array(2).join(lorem + '\n\n'), {
      fontSize: 14, lineSpacing: 1.35, textAlign: 'justify', color: 0xdddddd
    })

    table = doc.table({
      headerRows: 1, fontSize: 14,
      borderHorizontalWidth: 0.1,
      widths: ['10%', '10%', '50%', '15%', '15%']
    })

    tr = table.tr({ font: assets.openSansBold, borderBottomWidth: 1.5 })
    tr.td('#')
    tr.td('Unit')
    tr.td('Subject')
    tr.td('Price')
    tr.td('Total')

    // tr = table.beforeBreak()
    // tr.td('Subtotal', { colspan: 4 })
    // tr.td('1000.00 €', { textAlign: 'right' })

    var rows = [
      {
        quantity: 2,
        name: 'Article A',
        description: lorem,
        price: 500
      },
      {
        quantity: 1,
        name: 'Article B',
        description: lorem,
        price: 250
      },
      {
        quantity: 3,
        name: 'Article C',
        description: lorem,
        price: 750
      }
    ]

    rows.forEach(function(row) {
      tr = table.tr()
      tr.td(row.quantity)
      tr.td('pc.')

      var article = tr.td().text()
      article.add(row.name, { fontSize: 14, font: assets.openSansBold })
             .br()
             .add(lorem, { fontSize: 11, textAlign: 'justify' })

      tr.td(row.price.toFixed(2) + ' €', { textAlign: 'right' })
      tr.td((row.price * row.quantity).toFixed(2) + ' €', { textAlign: 'right' })
    })

    return doc
  }

  var steps = 9, step = 0, progressbar = document.querySelector('#progressbar')
  function progress(task) {
    progressbar.setAttribute('style', 'width: ' + Math.round(step++ / steps * 100) + '%')
    progressbar.innerHTML = task

    if (step === steps) {
      document.querySelector('#progress').setAttribute('style', 'display:none')
    }
  }

  var assets = {
    logo:                 'images/logo.pdf',
    openSansRegular:      'fonts/OpenSans/regular.ttf',
    openSansBold:         'fonts/OpenSans/bold.ttf',
    openSansLight:        'fonts/OpenSans/light.ttf',
    sourceCodeProMedium:  'fonts/SourceCodePro/medium.ttf'
  }

  progress('Loading assets')

  var keys  = Object.keys(assets)
  var count = keys.length
  var src   = {}

  keys.forEach(function(key) {
    var path = assets[key]

    pdfjs.load(path, function(err, buf) {
      if (err) throw err
      src[key] = buf

      progress('Loading assets')

      console.log(src, count)
      if (--count === 0) {
        progress('Compute pdf')
        var doc = build({
          logo:                 new pdfjs.Image(src.logo),
          openSansRegular:      new pdfjs.TTFFont(src.openSansRegular),
          openSansBold:         new pdfjs.TTFFont(src.openSansBold),
          openSansLight:        new pdfjs.TTFFont(src.openSansLight),
          sourceCodeProMedium:  new pdfjs.TTFFont(src.sourceCodeProMedium)
        })

        progress('Render pdf')

        var pdf = doc.render()

        document.querySelector('#preview').setAttribute('src', pdf.toDataURL())
        progress('Done')
      }
    })
  })
</script>